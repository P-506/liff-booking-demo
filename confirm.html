<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbw9Jg-z0bB6QMjdxXufLQx66CLuybPgcdPQWTs845MdfNnuA_4baUBsn214oCxywEA/exec";

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á iframe ‡∏•‡πà‡∏≠‡∏á‡∏´‡∏ô (‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
  const iframe = document.createElement("iframe");
  iframe.name = "hidden_iframe";
  iframe.style.display = "none";
  document.body.appendChild(iframe);

  document.getElementById("confirmBtn").addEventListener("click", () => {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
    const form = document.createElement("form");
    form.method = "POST";
    form.action = API_URL;
    form.target = "hidden_iframe"; // ‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å

    function addField(name, value) {
      const input = document.createElement("input");
      input.type = "hidden";
      input.name = name;
      input.value = value || "";
      form.appendChild(input);
    }

    addField("service_type", localStorage.getItem("service_type"));
    addField("area", localStorage.getItem("area"));
    addField("date", localStorage.getItem("date"));
    addField("slot", localStorage.getItem("slot"));

    document.body.appendChild(form);
    form.submit();

    // UX ‡∏ù‡∏±‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    alert("üéâ ‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    localStorage.clear();

    if (window.liff && liff.isInClient()) {
      liff.closeWindow();
    }
  });
</script>
